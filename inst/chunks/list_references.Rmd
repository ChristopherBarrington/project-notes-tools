```{r list_references, cache=FALSE, echo=FALSE, results='asis', eval=length(bibliography_doi)>0}
opts_current$get('title') %>%
  when(is.null(.) ~ 'References', TRUE~.) %>%
  sprintf(fmt='## %s\n\n') %>%
  cat()

file.path(knitting_path, 'scratch', 'bibliography.bib') %>%
  when(!file.exists(.)~stop('Could not read bibliography!'),
       TRUE~.) %>%
  RefManageR::ReadBib() %>%
  names() %>%
  str_replace_all(pattern='_', replacement='-') %>%
  str_to_lower() %>%
  str_replace_all('(:|/|\\.)+', '-') %>%
  file.path('publication', .) %>%
  sprintf(fmt='{{< cite page="%s" view="1" >}}\n') %>%
  str_c(collapse='') %>%
  cat()
```
